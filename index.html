<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Case of the Correlation Killer</title>

<style>
body {
    font-family: 'Courier New', monospace;
    background-color: rgb(10,0,0);
    color: #eee;
    text-align: center;
    padding: 20px;
    overflow-x: hidden;
    transition: background-color 1.5s ease;
}

h1 {
    color: crimson;
    text-shadow: 0 0 10px red;
}

.card {
    background: #1c1c1c;
    padding: 20px;
    margin: 20px auto;
    border-radius: 10px;
    max-width: 700px;
    box-shadow: 0 0 20px crimson;
}

button {
    padding: 10px 20px;
    margin: 10px;
    background-color: crimson;
    border: none;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.2s;
}

button:hover {
    background-color: darkred;
    transform: scale(1.05);
}

.correct { color: lightgreen; }
.wrong { color: orange; }

#jumpscare {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
    opacity: 0;
    transition: opacity 0.5s ease-in-out, transform 5s ease-in-out;
    transform: scale(1);
    z-index: 9999;
}

canvas {
    background: #111;
    border: 2px solid crimson;
    margin-top: 20px;
}

.shake {
    animation: shake 0.4s;
}

@keyframes shake {
    0% { transform: translate(5px, 5px); }
    25% { transform: translate(-5px, 5px); }
    50% { transform: translate(5px, -5px); }
    75% { transform: translate(-5px, -5px); }
    100% { transform: translate(0px, 0px); }
}

#endingScreen {
    position: fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:black;
    color:white;
    display:none;
    justify-content:center;
    align-items:center;
    text-align:center;
    font-size:2rem;
    z-index:10000;
    flex-direction:column;
}
</style>
</head>

<body>

<h1>üïµÔ∏è The Case of the Correlation Killer</h1>

<audio id="bgMusic" loop>
    <source src="scary.mp3" type="audio/mpeg">
</audio>

<audio id="screamSound">
    <source src="scream.mp3" type="audio/mpeg">
</audio>

<img id="jumpscare" src="jumpscare.png">

<div class="card">
    <div id="questionArea"></div>
    <div id="feedback"></div>
</div>

<div id="endingScreen"></div>

<script>
let currentQuestion = 0;
let darkness = 10;
let bossMode = false;

const questions = [
{
    question: "1) What type of variables are required for a scatterplot?",
    options: ["Two categorical","Two quantitative","Mixed","Any"],
    answer: 1
},
{
    question: "2) If X increases and Y decreases, the direction is:",
    options: ["Positive","Negative","Curved","None"],
    answer: 1
},
{
    question: "3) If points follow a straight line, the form is:",
    options: ["Curved","Linear","Clustered","Random"],
    answer: 1
},
{
    question: "4) Correlation r must be between:",
    options: ["0 to 1","-1 to 1","-10 to 10","No limit"],
    answer: 1
},
{
    question: "5) Correlation does NOT imply:",
    options: ["Association","Causation","Direction","Strength"],
    answer: 1
}
];

document.body.addEventListener("click", function() {
    document.getElementById("bgMusic").play();
}, { once: true });

function dimScreen() {
    darkness += 20;
    document.body.style.backgroundColor = `rgb(${darkness/2},0,0)`;
}

function triggerJumpScare() {
    let scare = document.getElementById("jumpscare");
    let scream = document.getElementById("screamSound");

    scare.style.display = "block";
    scare.style.opacity = "1";
    scare.style.transform = "scale(1.2)";
    scream.play();
    document.body.classList.add("shake");

    setTimeout(() => {
        scare.style.opacity = "0";
        scare.style.transform = "scale(1)";
        setTimeout(() => {
            scare.style.display = "none";
            document.body.classList.remove("shake");
        }, 500);
    }, 5000);
}

function loadQuestion() {

    if (currentQuestion >= questions.length && !bossMode) {
        loadBoss();
        return;
    }

    if (bossMode) return;

    let q = questions[currentQuestion];
    let html = "<h2>" + q.question + "</h2>";

    q.options.forEach((option, index) => {
        html += `<button onclick="checkAnswer(${index})">${option}</button><br>`;
    });

    document.getElementById("questionArea").innerHTML = html;
    document.getElementById("feedback").innerHTML = "";
}

function checkAnswer(selected) {
    let correct = questions[currentQuestion].answer;

    if (selected !== correct) {
        triggerJumpScare();
        document.getElementById("feedback").innerHTML =
            "<p class='wrong'>Incorrect...</p>";
    } else {
        document.getElementById("feedback").innerHTML =
            "<p class='correct'>Correct.</p>";
    }

    dimScreen(); // dims EVERY question

    currentQuestion++;
    setTimeout(loadQuestion, 2000);
}

/* FINAL BOSS */
function loadBoss() {
    bossMode = true;

    let html = `
        <h2>‚ò† FINAL BOSS: Interpret the Scatterplot ‚ò†</h2>
        <p>What is the relationship shown?</p>
        <canvas id="bossPlot" width="400" height="300"></canvas><br>
        <button onclick="checkBoss(0)">Strong Positive Linear</button>
        <button onclick="checkBoss(1)">Strong Negative Linear</button>
        <button onclick="checkBoss(2)">No Linear Relationship</button>
    `;

    document.getElementById("questionArea").innerHTML = html;
    drawScatter();
}

function drawScatter() {
    const canvas = document.getElementById("bossPlot");
    const ctx = canvas.getContext("2d");

    ctx.fillStyle = "white";

    for (let i = 0; i < 30; i++) {
        let x = 50 + i*10;
        let y = 250 - i*6 + (Math.random()*20 - 10);
        ctx.beginPath();
        ctx.arc(x, y, 4, 0, 2*Math.PI);
        ctx.fill();
    }
}

/* Correct answer is Strong Negative Linear (option 1) */
function checkBoss(choice) {

    if (choice === 1) {
        endGame();
    } else {
        triggerJumpScare();
        dimScreen();
        document.getElementById("feedback").innerHTML =
            "<p class='wrong'>The killer feeds on misinterpretation...</p>";
    }
}

function endGame() {
    document.getElementById("endingScreen").style.display = "flex";
    document.getElementById("endingScreen").innerHTML = `
        <div>
        <p>You survived tonight...</p>
        <p>But he will be back.</p>
        <p>For vengeance.</p>
        </div>
    `;
}

loadQuestion();
</script>

</body>
</html>
